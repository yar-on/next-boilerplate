# i18n Rules (next-intl)

## Locales

```typescript
// src/i18n/config.ts
export const locales      = ['en', 'he'] as const;
export type LocaleType    = (typeof locales)[number]; // 'en' | 'he'
export const defaultLocale: LocaleType = 'he';
export const localePrefix = 'as-needed' as const; // hides default locale from URL

export const localeDirections: Record<LocaleType, 'ltr' | 'rtl'> = {
  en: 'ltr',
  he: 'rtl',  // Hebrew is RTL
};
```

- Default locale: `he` (Hebrew) — may not appear in URL path
- Supported: `en` (English) and `he` (Hebrew)
- RTL/LTR direction is synced with the MUI theme and `<html dir>`

## Translations in Server Components

```tsx
import { getTranslations, setRequestLocale, getLocale } from 'next-intl/server';

export default async function Page({ params }: { params: Promise<{ locale: string }> }) {
  const { locale } = await params;
  setRequestLocale(locale); // ALWAYS call this for static rendering

  const t       = await getTranslations({ locale, namespace: 'pages.home' });
  const tCommon = await getTranslations({ locale, namespace: 'common' });

  return <h1>{t('title')}</h1>;
}
```

## Translations in Client Components

```tsx
'use client';
import { useTranslations, useLocale } from 'next-intl';

export function MyComponent() {
  const t      = useTranslations('common');    // namespace
  const locale = useLocale();                  // 'en' | 'he'

  return <span>{t('welcome', { name: 'User' })}</span>;
}
```

## Navigation — ALWAYS from `@/i18n/navigation`

```tsx
// NEVER use next/link or next/navigation directly
import { Link, useRouter, usePathname, redirect } from '@/i18n/navigation';

// Link (works like next/link but locale-aware)
<Link href="/about">About</Link>

// Programmatic navigation
const router   = useRouter();
const pathname = usePathname();

// Locale switching with startTransition
const [isPending, startTransition] = useTransition();
startTransition(() => {
  router.replace(pathname, { locale: newLocale });
});
```

## Locale file structure

Both `src/locales/en.json` and `src/locales/he.json` must stay in sync.

```json
{
  "common": {
    "loading": "Loading...",
    "error":   "Error",
    "save":    "Save"
  },
  "metadata": {
    "default": { "title": "...", "description": "..." },
    "home":    { "title": "...", "description": "..." }
  },
  "pages": {
    "home": {
      "title": "...",
      "features": {
        "items": { "nextjs": "...", "react": "..." }
      }
    }
  },
  "buttons": { "submit": "Submit", "cancel": "Cancel" },
  "forms": {
    "labels":       { "email": "..." },
    "placeholders": { "email": "..." },
    "errors":       { "required": "..." }
  }
}
```

- Keys: `camelCase` inside namespaces (e.g., `invalidEmail`, not `invalid-email`)
- Namespaces: `camelCase` (e.g., `pages.home.features.items`)
- Parameterized strings: `"welcome": "Welcome, {name}!"`
- ALWAYS update BOTH locale files — never one without the other

## Layout: font + direction switching

```tsx
// src/app/[locale]/layout.tsx
const direction  = localeDirections[locale as LocaleType]; // 'ltr' | 'rtl'
const fontClass  = locale === 'he' ? heebo.className : inter.className;

return (
  <html lang={locale} dir={direction}>
    <body className={fontClass}>
      <NextIntlClientProvider messages={messages}>
        {children}
      </NextIntlClientProvider>
    </body>
  </html>
);
```

- Hebrew (`he`): Heebo font
- English (`en`): Inter font
- `dir` attribute drives MUI RTL/LTR automatically via theme direction
